pipeline {
    agent any
    environment {
       ANSIBLE_CONFIG=/var/lib/jenkins/jobs/config-mgt-ansible/branches/feature-project14.bumlt0/workspace/deployment/roles/.ansible.cfg
    }


  stages {
    stage('SCM checkout') {
      steps {
       checkout([$class: 'GitSCM',
	  branches: [[name: '*/feature/project14']],
          userRemoteConfigs: [[url: 'https://github.com/sidahal2018/config-mgt-ansible.git']],
          extensions: [[$class: 'RelativeTargetDirectory', relativeTargetDir: 'deployment']]])

      }
    }
	stage('Export ansible.cfg') {
      steps {
          sh 'export $ANSIBLE_CONFIG'
      }
    }
	
	
    stage('Execute Ansible') {
      steps {
          ansiblePlaybook credentialsId: 'private-key-tooling', disableHostKeyChecking: true, installation: 'ansible', inventory: 'inventory/dev', playbook: 'playbooks/site.yml'
      }
    }
    }
}
